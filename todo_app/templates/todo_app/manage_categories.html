{% extends 'todo_app/base.html' %}

{% block title %}Manage Categories{% endblock %}

{% block content %}
<a href="{% url 'todo_list' %}" class="back-link">‚Üê Back to tasks</a>

<h2 style="color: #333; margin-bottom: 30px;">Manage Categories</h2>

<!-- Add New Category Form -->
<div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
    <h3 style="margin-bottom: 15px;">Add New Category</h3>
    <form method="post" style="display: flex; gap: 15px; align-items: end; flex-wrap: wrap;">
        {% csrf_token %}
        
        <div class="form-group" style="margin-bottom: 0; flex: 1; min-width: 200px;">
            <label for="name">Category Name *</label>
            <input type="text" id="name" name="name" required placeholder="e.g., Work, Personal, Shopping">
        </div>
        
        <div class="form-group" style="margin-bottom: 0;">
            <label for="color">Color</label>
            <input type="color" id="color" name="color" value="#667eea" 
                   style="height: 46px; padding: 5px; cursor: pointer;">
        </div>
        
        <button type="submit" class="btn">Add Category</button>
    </form>
</div>

<!-- Existing Categories -->
<h3 style="margin-bottom: 20px;">Existing Categories</h3>

{% if categories %}
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;">
        {% for category in categories %}
        <div style="
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        ">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div style="
                    width: 40px;
                    height: 40px;
                    background: {{ category.color }};
                    border-radius: 8px;
                "></div>
                <div>
                    <strong style="display: block; margin-bottom: 5px;">{{ category.name }}</strong>
                    <small style="color: #999;">{{ category.todos.count }} task(s)</small>
                </div>
            </div>
            
            <form method="post" action="{% url 'delete_category' category.id %}" style="display: inline;">
                {% csrf_token %}
                <button type="submit" 
                        class="btn btn-danger btn-small"
                        onclick="return confirm('Delete {{ category.name }}? Tasks will not be deleted.');">
                    Delete
                </button>
            </form>
        </div>
        {% endfor %}
    </div>
{% else %}
    <div style="text-align: center; padding: 40px; background: #f8f9fa; border-radius: 8px; color: #999;">
        <p>No categories yet. Create your first category above!</p>
    </div>
{% endif %}

<div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd;">
    <h4 style="margin-bottom: 10px;">Category Tips:</h4>
    <ul style="color: #666; line-height: 1.8;">
        <li>Use categories to organize tasks by project, context, or area of life</li>
        <li>Choose distinct colors to easily identify tasks at a glance</li>
        <li>Common categories: Work, Personal, Shopping, Health, Learning</li>
        <li>Deleting a category won't delete your tasks</li>
    </ul>
</div>
{% endblock %}
